<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" lang="pt-BR">
		<meta content='width=device-width, initial-scale=1, maximum-scale=1' name='viewport'/>
        <title>Add Home-Screen</title>
        <link rel="icon" href="imgs/icon512.png" type="image/png" sizes="16x16">
        <link rel="manifest" href="manifest.json">
        <!-- [ Theme Color ] -->
        <!-- Chrome, Firefox OS and Opera -->
        <meta content='#ff4444' name='theme-color'/>
        <!-- Windows Phone -->
        <meta content='#ff4444' name='msapplication-navbutton-color'/>
        <!-- iOS Safari -->
        <meta content='#ff4444' name='apple-mobile-web-app-status-bar-style'/>
        
        <style type="text/css">
            body {
                background: #ffffff;
                font-family: 'Roboto', sans-serif;
            }

            .add-to-btn {
                background-color: #06c;
                color: #fff;
                outline: none;
                font-weight: bold;
                height: 30px;
                border: 1px solid #06c;
                border-radius: 10px;
                cursor: pointer;
                white-space: nowrap;
            }
			h1{color:#06c}
			h2{color:#555;}
        </style>
    </head>
    <body>
        <div class="container">
            <h1 style="text-align:center;font-weigth:400;">Add Home-Screen</h1>
            <h2 style="text-align:center;font-weight:500;">Canapum Creative</h2>
            <center>
                <img src="imgs/html_css.png" style="width:70%"/>
            </center>
        </div>
        <div style="position: fixed; bottom: 10px; right: 20px;">
            <div class="add-to">
                <button class="add-to-btn">App Install</button>
                <!-- service-work -->
                <script type="text/javascript">
                    if ('serviceWorker'in navigator) {
                        window.addEventListener('load', function() {
                            navigator.serviceWorker.register('/home-screen/sw.js').then(function(registration) {
                                // Registration was successful
                                console.log('ServiceWorker registration successful with scope: ', registration.scope);
                            }, function(err) {
                                // registration failed :(
                                console.log('ServiceWorker registration failed: ', err);
                            });
                        });
                    }

                    let deferredPrompt;
                    var div = document.querySelector('.add-to');
                    var button = document.querySelector('.add-to-btn');
                    div.style.display = 'none';

                    window.addEventListener('beforeinstallprompt', (e)=>{
                        // Prevent Chrome 67 and earlier from automatically showing the prompt
                        e.preventDefault();
                        // Stash the event so it can be triggered later.
                        deferredPrompt = e;
                        div.style.display = 'block';

                        button.addEventListener('click', (e)=>{
                            // hide our user interface that shows our A2HS button
                            div.style.display = 'none';
                            // Show the prompt
                            deferredPrompt.prompt();
                            // Wait for the user to respond to the prompt
                            deferredPrompt.userChoice.then((choiceResult)=>{
                                if (choiceResult.outcome === 'accepted') {
                                    console.log('User accepted the A2HS prompt');
                                } else {
                                    console.log('User dismissed the A2HS prompt');
                                }
                                deferredPrompt = null;
                            }
                            );
                        }
                        );
                    }
                    );
                </script>
            </div>
    </body>
</html>
